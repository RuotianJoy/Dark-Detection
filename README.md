# 温度分析与曲线拟合

本项目使用三次样条插值和线性插值的组合方法对基于帧的温度数据进行分析。

## 概述

代码处理Excel文件中的温度数据，并创建分段拟合曲线，具有以下特点：
- 帧数 < 27000：使用三次样条插值
- 帧数 ≥ 27000：使用线性插值

## 功能特点

1. **数据处理**
   - 从"变化帧.xlsx"读取温度数据
   - 处理帧编号和对应温度
   - 在帧数27000处分割数据，用于不同的插值方法

2. **插值方法**
   - **三次样条插值**（帧数 < 27000）
     - 使用 `scipy.interpolate.CubicSpline`
     - 自然边界条件
   - **线性插值**（帧数 ≥ 27000）
     - 使用 `scipy.interpolate.interp1d`
     - 启用外推功能

3. **可视化**
   - 生成组合图表显示：
     - 原始数据点（红色散点）
     - 拟合曲线（蓝色线条）
   - 包含网格、图例和适当的标签
   - 图表标题："优化的分段拟合曲线（27000后线性插值）"

4. **数据导出**
   - 每30帧生成一个拟合温度值
   - 范围：0至50580帧
   - 导出结果到"拟合数据.xlsx"

## 数学公式

数据使用两个方程进行拟合：

1. 帧数 ≤ 27000：
   - 三次样条方程（自然边界条件）
   - 形式：`y = ax³ + bx² + cx + d`

2. 帧数 > 27000：
   - 线性方程
   - 形式：`y = 0.10000x + 43.80000`

## 依赖库

- numpy（数值计算）
- pandas（数据处理）
- matplotlib（绘图）
- scipy（科学计算）

## 输出文件

1. **可视化图表**
   - 显示拟合曲线和原始数据点
   - 包含两个插值区域

2. **Excel输出**
   - 文件名："拟合数据.xlsx"
   - 包含列：
     - 帧编号
     - 拟合温度
   - 每30帧记录一个数据点